<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supplier Database - Yanmar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'yanmar-red': '#DC2626',
                        'yanmar-light': '#FEF2F2',
                        'yanmar-dark': '#991B1B'
                    }
                }
            }
        }
    </script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .status-active {
            background-color: #10B981;
        }

        .status-inactive {
            background-color: #EF4444;
        }

        .table-hover:hover {
            background-color: #F9FAFB;
        }
    </style>
</head>

<body class="bg-gray-50 font-sans">
    <!-- Header -->
    <div class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-4">
                    <img src="https://via.placeholder.com/150x50/DC2626/FFFFFF?text=YANMAR" alt="Yanmar" class="h-10">
                    <h1 class="text-xl font-semibold text-gray-900">QC Management System</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <button class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-user-circle text-2xl"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Page Title and Add Button -->
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-gray-900">Supplier Database</h2>
            <button id="addSupplierBtn"
                class="bg-yanmar-red text-white px-4 py-2 rounded-md hover:bg-yanmar-dark flex items-center space-x-2">
                <i class="fas fa-plus"></i>
                <span>Add Supplier</span>
            </button>
        </div>

        <!-- Search and Filter Bar -->
        <div class="bg-white rounded-lg shadow mb-6">
            <div class="p-6">
                <div class="flex flex-col sm:flex-row gap-4">
                    <div class="flex-1">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Search Suppliers</label>
                        <div class="relative">
                            <input type="text" id="searchInput"
                                class="w-full px-3 py-2 pl-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yanmar-red focus:border-yanmar-red"
                                placeholder="Search by company name, PIC, or email...">
                            <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                        </div>
                    </div>
                    <div class="sm:w-48">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Filter by Status</label>
                        <select id="statusFilter"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yanmar-red focus:border-yanmar-red">
                            <option value="">All Status</option>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                        </select>
                    </div>
                    <div class="sm:w-48">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Filter by Country</label>
                        <select id="countryFilter"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yanmar-red focus:border-yanmar-red">
                            <option value="">All Countries</option>
                            <option value="Japan">Japan</option>
                            <option value="USA">USA</option>
                            <option value="Germany">Germany</option>
                            <option value="China">China</option>
                            <option value="South Korea">South Korea</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- Suppliers Table -->
        <div class="bg-white rounded-lg shadow">
            <div class="px-6 py-4 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h2 class="text-lg font-medium text-gray-900">Supplier List</h2>
                    <span id="totalCount" class="text-sm text-gray-500">Total: 12 suppliers</span>
                </div>
            </div>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Company</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                PIC</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Phone</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Email</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Avg Response</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                NCR History</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Status</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Actions</th>
                        </tr>
                    </thead>
                    <tbody id="suppliersTableBody" class="bg-white divide-y divide-gray-200">
                        <!-- Table rows will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Empty State -->
        <div id="emptyState" class="hidden bg-white rounded-lg shadow p-12 text-center">
            <i class="fas fa-search text-4xl text-gray-300 mb-4"></i>
            <h3 class="text-lg font-medium text-gray-900 mb-2">No suppliers found</h3>
            <p class="text-gray-500">Try adjusting your search or filter criteria</p>
        </div>
    </div>

    <!-- Add/Edit Supplier Modal -->
    <div id="supplierModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h3 id="modalTitle" class="text-lg font-medium text-gray-900">Add New Supplier</h3>
                    <button id="closeModal" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <form id="supplierForm" class="p-6 space-y-6">
                <!-- Basic Information -->
                <div>
                    <h4 class="text-md font-medium text-gray-900 mb-4">Basic Information</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Company Name *</label>
                            <input type="text" name="companyName" required
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yanmar-red focus:border-yanmar-red">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">PIC (Person in Charge) *</label>
                            <input type="text" name="pic" required
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yanmar-red focus:border-yanmar-red">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Phone *</label>
                            <input type="tel" name="phone" required
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yanmar-red focus:border-yanmar-red">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Email *</label>
                            <input type="email" name="email" required
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yanmar-red focus:border-yanmar-red">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Fax</label>
                            <input type="tel" name="fax"
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yanmar-red focus:border-yanmar-red">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Emergency Phone</label>
                            <input type="tel" name="emergencyPhone"
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yanmar-red focus:border-yanmar-red">
                        </div>
                    </div>
                </div>

                <!-- Address Information -->
                <div>
                    <h4 class="text-md font-medium text-gray-900 mb-4">Address Information</h4>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Street Address *</label>
                            <textarea name="address" required rows="2"
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yanmar-red focus:border-yanmar-red"></textarea>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">City *</label>
                                <input type="text" name="city" required
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yanmar-red focus:border-yanmar-red">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">State/Province</label>
                                <input type="text" name="state"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yanmar-red focus:border-yanmar-red">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Postal Code</label>
                                <input type="text" name="postalCode"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yanmar-red focus:border-yanmar-red">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Country *</label>
                            <select name="country" required
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yanmar-red focus:border-yanmar-red">
                                <option value="">Select Country</option>
                                <option value="Japan">Japan</option>
                                <option value="USA">USA</option>
                                <option value="Germany">Germany</option>
                                <option value="China">China</option>
                                <option value="South Korea">South Korea</option>
                                <option value="Taiwan">Taiwan</option>
                                <option value="Thailand">Thailand</option>
                                <option value="Singapore">Singapore</option>
                                <option value="India">India</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Business Information -->
                <div>
                    <h4 class="text-md font-medium text-gray-900 mb-4">Business Information</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Business Type</label>
                            <select name="businessType"
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yanmar-red focus:border-yanmar-red">
                                <option value="">Select Type</option>
                                <option value="Manufacturing">Manufacturing</option>
                                <option value="Trading">Trading</option>
                                <option value="Service">Service</option>
                                <option value="Distribution">Distribution</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Status *</label>
                            <select name="status" required
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yanmar-red focus:border-yanmar-red">
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Registration Date</label>
                            <input type="date" name="registrationDate"
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yanmar-red focus:border-yanmar-red">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Credit Rating</label>
                            <select name="creditRating"
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yanmar-red focus:border-yanmar-red">
                                <option value="">Select Rating</option>
                                <option value="A">A - Excellent</option>
                                <option value="B">B - Good</option>
                                <option value="C">C - Fair</option>
                                <option value="D">D - Poor</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Additional Notes -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Additional Notes</label>
                    <textarea name="notes" rows="3"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-yanmar-red focus:border-yanmar-red"
                        placeholder="Any additional information about the supplier..."></textarea>
                </div>

                <div class="flex justify-end space-x-3 pt-6 border-t border-gray-200">
                    <button type="button" id="cancelBtn"
                        class="px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50">
                        Cancel
                    </button>
                    <button type="submit" class="px-6 py-2 bg-yanmar-red text-white rounded-md hover:bg-yanmar-dark">
                        <span id="submitBtnText">Add Supplier</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Supplier Detail Modal -->
    <div id="detailModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-screen overflow-y-auto">
            <div class="px-6 py-4 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h3 class="text-lg font-medium text-gray-900">Supplier Details</h3>
                    <div class="flex space-x-2">
                        <button id="editSupplierBtn"
                            class="px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700">
                            <i class="fas fa-edit mr-1"></i>Edit
                        </button>
                        <button id="closeDetailModal" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div id="supplierDetailContent" class="p-6">
                <!-- Detail content will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // Sample supplier database
        let suppliers = [
            {
                id: 1,
                companyName: "ABC Manufacturing Co.",
                pic: "John Smith",
                phone: "+1-555-0101",
                email: "john@abc-mfg.com",
                fax: "+1-555-0111",
                emergencyPhone: "+1-555-0121",
                address: "1234 Industrial Ave, Suite 100",
                city: "Detroit",
                state: "Michigan",
                postalCode: "48201",
                country: "USA",
                businessType: "Manufacturing",
                status: "active",
                registrationDate: "2023-01-15",
                creditRating: "A",
                avgResponseTime: "2.3 hours",
                ncrHistory: 15,
                notes: "Primary supplier for engine components"
            },
            {
                id: 2,
                companyName: "XYZ Components Ltd.",
                pic: "Sarah Johnson",
                phone: "+1-555-0102",
                email: "sarah@xyz-components.com",
                fax: "+1-555-0112",
                emergencyPhone: "+1-555-0122",
                address: "5678 Tech Park Dr",
                city: "San Jose",
                state: "California",
                postalCode: "95110",
                country: "USA",
                businessType: "Manufacturing",
                status: "active",
                registrationDate: "2022-08-20",
                creditRating: "B",
                avgResponseTime: "4.1 hours",
                ncrHistory: 8,
                notes: "Specialized in electronic components"
            },
            {
                id: 3,
                companyName: "Global Parts Solutions",
                pic: "Mike Chen",
                phone: "+86-21-5555-0103",
                email: "mike@globalparts.com",
                fax: "+86-21-5555-0113",
                emergencyPhone: "+86-138-0000-0123",
                address: "No. 888 Huaxia West Road",
                city: "Shanghai",
                state: "Shanghai",
                postalCode: "200000",
                country: "China",
                businessType: "Trading",
                status: "active",
                registrationDate: "2023-03-10",
                creditRating: "B",
                avgResponseTime: "6.2 hours",
                ncrHistory: 23,
                notes: "International trading company"
            },
            {
                id: 4,
                companyName: "Premium Steel Works",
                pic: "Anna Rodriguez",
                phone: "+49-30-5555-0104",
                email: "anna@premiumsteel.com",
                fax: "+49-30-5555-0114",
                emergencyPhone: "+49-172-0000-0124",
                address: "Industriestraße 15",
                city: "Berlin",
                state: "Berlin",
                postalCode: "10117",
                country: "Germany",
                businessType: "Manufacturing",
                status: "active",
                registrationDate: "2022-11-05",
                creditRating: "A",
                avgResponseTime: "1.8 hours",
                ncrHistory: 12,
                notes: "High-quality steel and metal parts"
            },
            {
                id: 5,
                companyName: "Tech Assembly Inc.",
                pic: "David Kim",
                phone: "+82-2-5555-0105",
                email: "david@techassembly.com",
                fax: "+82-2-5555-0115",
                emergencyPhone: "+82-10-0000-0125",
                address: "456 Gangnam-daero, Gangnam-gu",
                city: "Seoul",
                state: "Seoul",
                postalCode: "06142",
                country: "South Korea",
                businessType: "Manufacturing",
                status: "active",
                registrationDate: "2023-02-28",
                creditRating: "A",
                avgResponseTime: "3.5 hours",
                ncrHistory: 7,
                notes: "Assembly and precision parts"
            },
            {
                id: 6,
                companyName: "Nippon Industries KK",
                pic: "Hiroshi Tanaka",
                phone: "+81-3-5555-0106",
                email: "tanaka@nippon-ind.co.jp",
                fax: "+81-3-5555-0116",
                emergencyPhone: "+81-90-0000-0126",
                address: "2-3-4 Shibuya, Shibuya-ku",
                city: "Tokyo",
                state: "Tokyo",
                postalCode: "150-0002",
                country: "Japan",
                businessType: "Manufacturing",
                status: "active",
                registrationDate: "2022-06-12",
                creditRating: "A",
                avgResponseTime: "1.2 hours",
                ncrHistory: 31,
                notes: "Long-term strategic partner"
            },
            {
                id: 7,
                companyName: "Euro Engineering GmbH",
                pic: "Klaus Mueller",
                phone: "+49-89-5555-0107",
                email: "klaus@euroeng.de",
                fax: "+49-89-5555-0117",
                emergencyPhone: "+49-175-0000-0127",
                address: "Maximilianstraße 35",
                city: "Munich",
                state: "Bavaria",
                postalCode: "80539",
                country: "Germany",
                businessType: "Service",
                status: "active",
                registrationDate: "2023-04-18",
                creditRating: "B",
                avgResponseTime: "5.7 hours",
                ncrHistory: 4,
                notes: "Engineering consulting services"
            },
            {
                id: 8,
                companyName: "Pacific Supplies Co.",
                pic: "Lisa Wong",
                phone: "+65-6555-0108",
                email: "lisa@pacific-supplies.sg",
                fax: "+65-6555-0118",
                emergencyPhone: "+65-9000-0128",
                address: "123 Marina Bay Street #15-01",
                city: "Singapore",
                state: "",
                postalCode: "018983",
                country: "Singapore",
                businessType: "Distribution",
                status: "active",
                registrationDate: "2023-01-25",
                creditRating: "B",
                avgResponseTime: "8.3 hours",
                ncrHistory: 19,
                notes: "Regional distribution network"
            },
            {
                id: 9,
                companyName: "Midwest Materials LLC",
                pic: "Robert Johnson",
                phone: "+1-555-0109",
                email: "robert@midwest-materials.com",
                fax: "+1-555-0119",
                emergencyPhone: "+1-555-0129",
                address: "789 Commerce Blvd",
                city: "Chicago",
                state: "Illinois",
                postalCode: "60601",
                country: "USA",
                businessType: "Trading",
                status: "inactive",
                registrationDate: "2022-09-14",
                creditRating: "C",
                notes: "Currently under review"
            },
            {
                id: 10,
                companyName: "Asian Auto Parts Ltd.",
                pic: "Raj Patel",
                phone: "+91-22-5555-0110",
                email: "raj@asianparts.in",
                fax: "+91-22-5555-0120",
                emergencyPhone: "+91-98-0000-0130",
                address: "Unit 45, Industrial Estate, Andheri East",
                city: "Mumbai",
                state: "Maharashtra",
                postalCode: "400069",
                country: "India",
                businessType: "Manufacturing",
                status: "active",
                registrationDate: "2023-05-30",
                creditRating: "B",
                notes: "Automotive parts specialist"
            },
            {
                id: 11,
                companyName: "Nordic Supply Chain AB",
                pic: "Erik Andersson",
                phone: "+46-8-5555-0111",
                email: "erik@nordicsupply.se",
                fax: "+46-8-5555-0121",
                emergencyPhone: "+46-70-0000-0131",
                address: "Storgatan 25",
                city: "Stockholm",
                state: "Stockholm",
                postalCode: "11157",
                country: "Sweden",
                businessType: "Distribution",
                status: "active",
                registrationDate: "2022-12-08",
                creditRating: "A",
                notes: "Northern European logistics"
            },
            {
                id: 12,
                companyName: "Precision Tools Corp.",
                pic: "Maria Garcia",
                phone: "+1-555-0112",
                email: "maria@precision-tools.com",
                fax: "+1-555-0122",
                emergencyPhone: "+1-555-0132",
                address: "321 Manufacturing Way",
                city: "Phoenix",
                state: "Arizona",
                postalCode: "85001",
                country: "USA",
                businessType: "Manufacturing",
                status: "inactive",
                registrationDate: "2022-04-22",
                creditRating: "D",
                notes: "Quality issues reported"
            }
        ];

        let filteredSuppliers = [...suppliers];
        let editingSupplier = null;

        // DOM Elements
        const searchInput = document.getElementById('searchInput');
        const statusFilter = document.getElementById('statusFilter');
        const countryFilter = document.getElementById('countryFilter');
        const suppliersTableBody = document.getElementById('suppliersTableBody');
        const totalCount = document.getElementById('totalCount');
        const emptyState = document.getElementById('emptyState');
        const addSupplierBtn = document.getElementById('addSupplierBtn');
        const supplierModal = document.getElementById('supplierModal');
        const detailModal = document.getElementById('detailModal');

        // Initialize page
        document.addEventListener('DOMContentLoaded', function () {
            renderTable();
            setupEventListeners();
        });

        function setupEventListeners() {
            // Search and filters
            searchInput.addEventListener('input', filterSuppliers);
            statusFilter.addEventListener('change', filterSuppliers);
            countryFilter.addEventListener('change', filterSuppliers);

            // Modal controls
            addSupplierBtn.addEventListener('click', () => openSupplierModal());
            document.getElementById('closeModal').addEventListener('click', closeSupplierModal);
            document.getElementById('cancelBtn').addEventListener('click', closeSupplierModal);
            document.getElementById('closeDetailModal').addEventListener('click', closeDetailModal);

            // Form submission
            document.getElementById('supplierForm').addEventListener('submit', handleSupplierSubmit);

            // Edit button in detail modal
            document.getElementById('editSupplierBtn').addEventListener('click', function () {
                closeDetailModal();
                openSupplierModal(editingSupplier);
            });
        }

        function filterSuppliers() {
            const searchTerm = searchInput.value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const countryFilter = document.getElementById('countryFilter').value;

            filteredSuppliers = suppliers.filter(supplier => {
                const matchesSearch = !searchTerm ||
                    supplier.companyName.toLowerCase().includes(searchTerm) ||
                    supplier.pic.toLowerCase().includes(searchTerm) ||
                    supplier.email.toLowerCase().includes(searchTerm);

                const matchesStatus = !statusFilter || supplier.status === statusFilter;
                const matchesCountry = !countryFilter || supplier.country === countryFilter;

                return matchesSearch && matchesStatus && matchesCountry;
            });

            renderTable();
        }

        function renderTable() {
            if (filteredSuppliers.length === 0) {
                suppliersTableBody.innerHTML = '';
                document.querySelector('.bg-white.rounded-lg.shadow').classList.add('hidden');
                emptyState.classList.remove('hidden');
                return;
            }

            document.querySelector('.bg-white.rounded-lg.shadow').classList.remove('hidden');
            emptyState.classList.add('hidden');

            suppliersTableBody.innerHTML = filteredSuppliers.map(supplier => `
                <tr class="table-hover">
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">${supplier.companyName}</div>
                        <div class="text-sm text-gray-500">${supplier.businessType || 'N/A'}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${supplier.pic}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${supplier.phone}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${supplier.email}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${supplier.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                            ${supplier.status.charAt(0).toUpperCase() + supplier.status.slice(1)}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="viewSupplierDetail(${supplier.id})" class="text-blue-600 hover:text-blue-900 mr-3">
                            <i class="fas fa-eye"></i> View
                        </button>
                        <button onclick="openSupplierModal(${supplier.id})" class="text-indigo-600 hover:text-indigo-900">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                    </td>
                </tr>
            `).join('');

            totalCount.textContent = `Total: ${filteredSuppliers.length} suppliers`;
        }

        function openSupplierModal(supplierId = null) {
            editingSupplier = supplierId;
            const modal = document.getElementById('supplierModal');
            const form = document.getElementById('supplierForm');
            const title = document.getElementById('modalTitle');
            const submitBtn = document.getElementById('submitBtnText');

            if (supplierId) {
                const supplier = suppliers.find(s => s.id === supplierId);
                if (supplier) {
                    title.textContent = 'Edit Supplier';
                    submitBtn.textContent = 'Update Supplier';

                    // Populate form with existing data
                    Object.keys(supplier).forEach(key => {
                        const input = form.querySelector(`[name="${key}"]`);
                        if (input && key !== 'id') {
                            input.value = supplier[key] || '';
                        }
                    });
                }
            } else {
                title.textContent = 'Add New Supplier';
                submitBtn.textContent = 'Add Supplier';
                form.reset();
            }

            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        function closeSupplierModal() {
            document.getElementById('supplierModal').classList.add('hidden');
            document.getElementById('supplierModal').classList.remove('flex');
            editingSupplier = null;
        }

        function handleSupplierSubmit(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const supplierData = Object.fromEntries(formData.entries());

            if (editingSupplier) {
                // Update existing supplier
                const index = suppliers.findIndex(s => s.id === editingSupplier);
                if (index !== -1) {
                    suppliers[index] = { ...suppliers[index], ...supplierData };
                }
            } else {
                // Add new supplier
                const newId = Math.max(...suppliers.map(s => s.id)) + 1;
                suppliers.push({ id: newId, ...supplierData });
            }

            closeSupplierModal();
            filterSuppliers(); // Refresh the table

            // Show success message
            const action = editingSupplier ? 'updated' : 'added';
            alert(`Supplier ${action} successfully!`);
        }

        function viewSupplierDetail(supplierId) {
            const supplier = suppliers.find(s => s.id === supplierId);
            if (!supplier) return;

            editingSupplier = supplierId;
            const content = document.getElementById('supplierDetailContent');

            content.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="text-md font-medium text-gray-900 mb-4">Basic Information</h4>
                        <div class="space-y-3">
                            <div>
                                <span class="text-sm font-medium text-gray-500">Company:</span>
                                <p class="text-sm text-gray-900">${supplier.companyName}</p>
                            </div>
                            <div>
                                <span class="text-sm font-medium text-gray-500">PIC:</span>
                                <p class="text-sm text-gray-900">${supplier.pic}</p>
                            </div>
                            <div>
                                <span class="text-sm font-medium text-gray-500">Phone:</span>
                                <p class="text-sm text-gray-900">${supplier.phone}</p>
                            </div>
                            <div>
                                <span class="text-sm font-medium text-gray-500">Email:</span>
                                <p class="text-sm text-gray-900">${supplier.email}</p>
                            </div>
                            <div>
                                <span class="text-sm font-medium text-gray-500">Fax:</span>
                                <p class="text-sm text-gray-900">${supplier.fax || 'N/A'}</p>
                            </div>
                            <div>
                                <span class="text-sm font-medium text-gray-500">Emergency Phone:</span>
                                <p class="text-sm text-gray-900">${supplier.emergencyPhone || 'N/A'}</p>
                            </div>
                        </div>
                    </div>

                    <div>
                        <h4 class="text-md font-medium text-gray-900 mb-4">Address</h4>
                        <div class="space-y-3">
                            <div>
                                <span class="text-sm font-medium text-gray-500">Address:</span>
                                <p class="text-sm text-gray-900">${supplier.address}</p>
                            </div>
                            <div>
                                <span class="text-sm font-medium text-gray-500">City:</span>
                                <p class="text-sm text-gray-900">${supplier.city}</p>
                            </div>
                            <div>
                                <span class="text-sm font-medium text-gray-500">State:</span>
                                <p class="text-sm text-gray-900">${supplier.state || 'N/A'}</p>
                            </div>
                            <div>
                                <span class="text-sm font-medium text-gray-500">Postal Code:</span>
                                <p class="text-sm text-gray-900">${supplier.postalCode}</p>
                            </div>
                            <div>
                                <span class="text-sm font-medium text-gray-500">Country:</span>
                                <p class="text-sm text-gray-900">${supplier.country}</p>
                            </div>
                        </div>
                    </div>

                    <div>
                        <h4 class="text-md font-medium text-gray-900 mb-4">Business Information</h4>
                        <div class="space-y-3">
                            <div>
                                <span class="text-sm font-medium text-gray-500">Business Type:</span>
                                <p class="text-sm text-gray-900">${supplier.businessType || 'N/A'}</p>
                            </div>
                            <div>
                                <span class="text-sm font-medium text-gray-500">Status:</span>
                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${supplier.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                                    ${supplier.status.charAt(0).toUpperCase() + supplier.status.slice(1)}
                                </span>
                            </div>
                            <div>
                                <span class="text-sm font-medium text-gray-500">Registration Date:</span>
                                <p class="text-sm text-gray-900">${supplier.registrationDate || 'N/A'}</p>
                            </div>
                            <div>
                                <span class="text-sm font-medium text-gray-500">Credit Rating:</span>
                                <p class="text-sm text-gray-900">${supplier.creditRating || 'N/A'}</p>
                            </div>
                        </div>
                    </div>

                    <div>
                        <h4 class="text-md font-medium text-gray-900 mb-4">Additional Notes</h4>
                        <p class="text-sm text-gray-900">${supplier.notes || 'No additional notes'}</p>
                    </div>
                </div>
            `;

            document.getElementById('detailModal').classList.remove('hidden');
            document.getElementById('detailModal').classList.add('flex');
        }

        function closeDetailModal() {
            document.getElementById('detailModal').classList.add('hidden');
            document.getElementById('detailModal').classList.remove('flex');
        }
    </script>
</body>

</html>