<!DOCTYPE html>
<html class="h-full" data-kt-theme="true" data-kt-theme-mode="light" dir="ltr" lang="en">

<head>
  <title>Yanmar Corporate - QC Dashboard</title>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport" />
  <meta content="Yanmar Corporate QC Dashboard" name="description" />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'yanmar-red': '#DC2626',
            'yanmar-dark': '#991B1B',
            'yanmar-light': '#FEE2E2',
            'yanmar-orange': '#EA580C',
            'yanmar-gray': '#374151'
          }
        }
      }
    }
  </script>
</head>

<body class="antialiased bg-slate-50 text-slate-900">

  <!-- Header Navigation -->
  <nav class="bg-white shadow-sm border-b border-slate-200 sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16">
        <!-- Logo & Brand -->
        <div class="flex items-center">
          <div class="flex items-center">
            <div class="w-10 h-10 bg-yanmar-blue rounded-lg mr-3 flex items-center justify-center">
              <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
                <path d="M10 2L3 7v11a1 1 0 001 1h12a1 1 0 001-1V7l-7-5z" />
              </svg>
            </div>
            <div>
              <h1 class="text-lg font-bold text-yanmar-dark">YANMAR</h1>
              <p class="text-xs text-slate-500">QC Dashboard</p>
            </div>
          </div>
        </div>

        <!-- User Menu -->
        <div class="flex items-center space-x-4">
          <div class="text-right">
            <p class="text-sm font-medium text-yanmar-dark">John Doe</p>
            <p class="text-xs text-slate-500">QC Inspector</p>
          </div>
          <div class="w-10 h-10 bg-yanmar-orange rounded-full flex items-center justify-center">
            <span class="text-white font-semibold">JD</span>
          </div>
          <button class="text-slate-400 hover:text-yanmar-red">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
            </svg>
          </button>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

    <!-- Page Header -->
    <div class="mb-8">
      <h2 class="text-3xl font-bold text-yanmar-dark mb-2">QC Part Submission</h2>
      <p class="text-slate-600">Submit quality control reports for incoming parts and components</p>
    </div>

    <!-- QC Form -->
    <div class="bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden">
      <div class="bg-gradient-to-r from-yanmar-red to-red-600 px-6 py-4">
        <h3 class="text-xl font-semibold text-white">New QC Report</h3>
        <p class="text-red-100 text-sm mt-1">Fill in all required information for the quality control inspection</p>
      </div>

      <form class="p-6 space-y-6" method="post" enctype="multipart/form-data">

        <!-- Data Parts Section -->
        <div class="mb-8">
          <h4 class="text-lg font-semibold text-yanmar-dark mb-6 flex items-center">
            <svg class="w-5 h-5 text-yanmar-red mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
            </svg>
            Data Parts
          </h4>

          <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 lg:gap-6">
            <!-- Part Number -->
            <div>
              <label class="block text-sm font-medium text-yanmar-gray mb-2">Part Number *</label>
              <input type="text" name="part_number"
                class="w-full px-4 py-3 bg-white border border-slate-300 rounded-lg focus:ring-2 focus:ring-yanmar-blue focus:border-transparent transition-all duration-200"
                placeholder="Enter part number" required />
            </div>

            <!-- Part Name -->
            <div>
              <label class="block text-sm font-medium text-yanmar-gray mb-2">Part Name *</label>
              <input type="number" name="part_name"
                class="w-full px-4 py-3 bg-white border border-slate-300 rounded-lg focus:ring-2 focus:ring-yanmar-blue focus:border-transparent transition-all duration-200"
                placeholder="Enter part name (numeric)" required />
            </div>

            <!-- Model -->
            <div>
              <label class="block text-sm font-medium text-yanmar-gray mb-2">Model *</label>
              <input type="text" name="model"
                class="w-full px-4 py-3 bg-white border border-slate-300 rounded-lg focus:ring-2 focus:ring-yanmar-blue focus:border-transparent transition-all duration-200"
                placeholder="Enter model" required />
            </div>

            <!-- Class Part -->
            <div>
              <label class="block text-sm font-medium text-yanmar-gray mb-2">Class Part *</label>
              <div class="relative">
                <select name="class_part"
                  class="w-full px-4 py-3 bg-white border border-slate-300 rounded-lg focus:ring-2 focus:ring-yanmar-red focus:border-transparent transition-all duration-200 appearance-none cursor-pointer"
                  required>
                  <option value="" disabled selected>Select class part</option>
                  <option value="safety">Safety</option>
                  <option value="function">Function</option>
                  <option value="general">General</option>
                </select>
                <div class="absolute inset-y-0 right-0 flex items-center px-3 pointer-events-none">
                  <svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                  </svg>
                </div>
              </div>
            </div>

            <!-- Location -->
            <div class="md:col-span-2">
              <label class="block text-sm font-medium text-yanmar-gray mb-2">Location *</label>
              <input type="text" name="location"
                class="w-full px-4 py-3 bg-white border border-slate-300 rounded-lg focus:ring-2 focus:ring-yanmar-red focus:border-transparent transition-all duration-200"
                placeholder="Enter location (e.g., Claim QC Incoming)" required />
            </div>
          </div>


          <!-- Problem Section -->
          <div class="mb-8 mt-8">
            <h4 class="text-lg font-semibold text-yanmar-dark mb-6 flex items-center">
              <svg class="w-5 h-5 text-yanmar-red mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.082 16.5c-.77.833.192 2.5 1.732 2.5z" />
              </svg>
              Problem
            </h4>

            <!-- Problem Statement -->
            <div class="mb-4">
              <label class="block text-sm font-medium text-yanmar-gray mb-2">Problem Statement *</label>
              <textarea name="problem_statement" rows="2"
                class="w-full px-4 py-3 bg-white border border-slate-300 rounded-lg focus:ring-2 focus:ring-yanmar-blue focus:border-transparent transition-all duration-200 resize-none"
                placeholder="Describe the problem in 2 lines maximum" required></textarea>
            </div>

            <!-- Detail of Problem -->
            <div class="mb-4">
              <label class="block text-sm font-medium text-yanmar-gray mb-2">Detail of Problem *</label>
              <textarea name="problem_detail" rows="4"
                class="w-full px-4 py-3 bg-white border border-slate-300 rounded-lg focus:ring-2 focus:ring-yanmar-blue focus:border-transparent transition-all duration-200"
                placeholder="Provide detailed description of the problem" required></textarea>
            </div>

            <!-- Upload Image & Video -->
            <div class="space-y-6">
              <div>
                <label class="block text-sm font-medium text-yanmar-gray mb-2">Upload Images</label>
                <div
                  class="border-2 border-dashed border-slate-300 rounded-lg p-4 hover:border-yanmar-red transition-colors min-h-32"
                  id="imageDropzone">
                  <input type="file" name="images" multiple accept="image/*" class="hidden" id="imageUpload">

                  <!-- Upload Prompt (shown when empty) -->
                  <div id="imageUploadPrompt" class="text-center">
                    <label for="imageUpload" class="cursor-pointer block">
                      <svg class="w-8 h-8 text-slate-400 mx-auto mb-2" fill="none" stroke="currentColor"
                        viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                      </svg>
                      <p class="text-sm text-slate-600">Click to upload images</p>
                      <p class="text-xs text-slate-400">PNG, JPG up to 10MB each</p>
                    </label>
                  </div>

                  <!-- Image Thumbnails -->
                  <div id="imageThumbnails" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3 hidden">
                  </div>

                  <!-- Add More Button (shown when have images) -->
                  <div id="addMoreImages" class="hidden mt-2">
                    <label for="imageUpload"
                      class="cursor-pointer inline-flex items-center px-3 py-1 text-xs bg-yanmar-red text-white rounded-full hover:bg-yanmar-dark transition-colors">
                      <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                      </svg>
                      Add More
                    </label>
                  </div>
                </div>
              </div>

              <div>
                <label class="block text-sm font-medium text-yanmar-gray mb-2">Upload Videos</label>
                <div
                  class="border-2 border-dashed border-slate-300 rounded-lg p-4 hover:border-yanmar-red transition-colors min-h-32"
                  id="videoDropzone">
                  <input type="file" name="videos" multiple accept="video/*" class="hidden" id="videoUpload">

                  <!-- Upload Prompt (shown when empty) -->
                  <div id="videoUploadPrompt" class="text-center">
                    <label for="videoUpload" class="cursor-pointer block">
                      <svg class="w-8 h-8 text-slate-400 mx-auto mb-2" fill="none" stroke="currentColor"
                        viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                      </svg>
                      <p class="text-sm text-slate-600">Click to upload videos</p>
                      <p class="text-xs text-slate-400">MP4, MOV up to 50MB each</p>
                    </label>
                  </div>

                  <!-- Video Thumbnails -->
                  <div id="videoThumbnails" class="grid grid-cols-1 sm:grid-cols-2 gap-4 hidden">
                  </div>

                  <!-- Add More Button (shown when have videos) -->
                  <div id="addMoreVideos" class="hidden mt-2">
                    <label for="videoUpload"
                      class="cursor-pointer inline-flex items-center px-3 py-1 text-xs bg-yanmar-red text-white rounded-full hover:bg-yanmar-dark transition-colors">
                      <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                      </svg>
                      Add More
                    </label>
                  </div>
                </div>
              </div>
            </div>

            <!-- Voice Note -->
            <div>
              <label class="block text-sm font-medium text-yanmar-gray mb-2">Voice Note</label>
              <div class="flex items-center space-x-4 p-4 bg-white border border-slate-300 rounded-lg">
                <button type="button" id="recordBtn"
                  class="flex items-center justify-center w-14 h-14 bg-yanmar-red hover:bg-yanmar-dark rounded-full transition-all duration-200 shadow-lg hover:shadow-xl">
                  <svg id="micIcon" class="w-7 h-7 text-white" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 2a3 3 0 00-3 3v6a3 3 0 006 0V5a3 3 0 00-3-3z" />
                    <path d="M19 10v1a7 7 0 01-14 0v-1a1 1 0 012 0v1a5 5 0 0010 0v-1a1 1 0 012 0z" />
                    <path d="M12 18.25a1 1 0 01-1-1v-1.5a1 1 0 012 0v1.5a1 1 0 01-1 1z" />
                    <path d="M8 20.75h8a1 1 0 010 2H8a1 1 0 010-2z" />
                  </svg>
                </button>
                <div class="flex-1">
                  <div class="flex items-center space-x-3">
                    <div id="waveform" class="hidden flex items-center space-x-1">
                      <div class="w-1 h-3 bg-yanmar-red rounded-full animate-pulse"></div>
                      <div class="w-1 h-5 bg-yanmar-red rounded-full animate-pulse delay-75"></div>
                      <div class="w-1 h-2 bg-yanmar-red rounded-full animate-pulse delay-150"></div>
                      <div class="w-1 h-4 bg-yanmar-red rounded-full animate-pulse delay-200"></div>
                      <div class="w-1 h-6 bg-yanmar-red rounded-full animate-pulse delay-100"></div>
                      <div class="w-1 h-3 bg-yanmar-red rounded-full animate-pulse delay-300"></div>
                      <div class="w-1 h-5 bg-yanmar-red rounded-full animate-pulse delay-250"></div>
                      <div class="w-1 h-2 bg-yanmar-red rounded-full animate-pulse delay-400"></div>
                    </div>
                    <span id="recordingStatus" class="text-sm text-slate-600 font-medium">Click microphone to start
                      recording</span>
                  </div>
                  <div id="recordingTimer" class="text-xs text-yanmar-red font-mono hidden mt-1">00:00</div>
                </div>
                <div class="hidden" id="voiceControls">
                  <button type="button" id="stopRecording"
                    class="px-3 py-1 text-xs bg-slate-200 text-slate-700 rounded hover:bg-slate-300 transition-colors mr-2">
                    Stop
                  </button>
                  <button type="button" id="playRecording"
                    class="px-3 py-1 text-xs bg-yanmar-red text-white rounded hover:bg-yanmar-dark transition-colors">
                    Play
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Process Flow Section -->
          <div class="mb-8">
            <h4 class="text-lg font-semibold text-yanmar-dark mb-6 flex items-center">
              <svg class="w-5 h-5 text-yanmar-red mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" />
              </svg>
              Process Flow
            </h4>

            <!-- Description -->
            <div class="mb-4">
              <label class="block text-sm font-medium text-yanmar-gray mb-2">Description *</label>
              <textarea name="process_description" rows="6"
                class="w-full px-4 py-3 bg-white border border-slate-300 rounded-lg focus:ring-2 focus:ring-yanmar-blue focus:border-transparent transition-all duration-200"
                placeholder="Provide detailed description of the process flow and recommended actions"
                required></textarea>
            </div>

            <!-- Attach Documents -->
            <div class="mb-6">
              <label class="block text-sm font-medium text-yanmar-gray mb-3">Attach Documents</label>
              <div
                class="border-2 border-dashed border-slate-300 rounded-lg p-6 hover:border-yanmar-red transition-colors"
                id="documentDropzone">
                <input type="file" name="documents" multiple accept=".pdf,.doc,.docx,.txt,.xls,.xlsx,.ppt,.pptx"
                  class="hidden" id="documentUpload">

                <!-- Upload Prompt (shown when empty) -->
                <div id="documentUploadPrompt" class="text-center">
                  <label for="documentUpload" class="cursor-pointer block">
                    <svg class="w-12 h-12 text-slate-400 mx-auto mb-3" fill="none" stroke="currentColor"
                      viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13" />
                    </svg>
                    <p class="text-sm text-slate-600 mb-1">Click to attach documents</p>
                    <p class="text-xs text-slate-400">PDF, DOC, DOCX, TXT, XLS, PPT up to 25MB each</p>
                  </label>
                </div>

                <!-- Document Thumbnails -->
                <div id="documentThumbnails" class="space-y-3 hidden">
                </div>

                <!-- Add More Button (shown when have documents) -->
                <div id="addMoreDocuments" class="hidden mt-4 text-center">
                  <label for="documentUpload"
                    class="cursor-pointer inline-flex items-center px-4 py-2 text-sm bg-yanmar-red text-white rounded-lg hover:bg-yanmar-dark transition-colors">
                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                    </svg>
                    Add More Documents
                  </label>
                </div>
              </div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="flex flex-col sm:flex-row gap-4 pt-6 border-t border-slate-200">
            <button type="button"
              class="flex-1 bg-slate-200 text-slate-700 py-3 px-6 rounded-lg font-semibold hover:bg-slate-300 transition-all duration-200 flex items-center justify-center">
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12" />
              </svg>
              Save Draft
            </button>

            <button type="submit"
              class="flex-1 bg-gradient-to-r from-yanmar-red to-red-600 text-white py-3 px-6 rounded-lg font-semibold hover:from-red-600 hover:to-yanmar-red transform hover:scale-[1.02] transition-all duration-200 flex items-center justify-center shadow-lg">
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
              </svg>
              Submit Report
            </button>
          </div>
      </form>
    </div>
  </div>

  <!-- Image & Video Modal -->
  <div id="mediaModal" class="fixed inset-0 bg-black bg-opacity-75 z-50 hidden flex items-center justify-center p-4">
    <div class="relative max-w-4xl max-h-full w-full">
      <!-- Close Button -->
      <button id="closeModal" class="absolute -top-10 right-0 text-white hover:text-yanmar-red text-2xl z-10">
        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>

      <!-- Modal Content -->
      <div id="modalContent" class="bg-white rounded-lg overflow-hidden shadow-2xl">
        <!-- Content will be dynamically inserted here -->
      </div>
    </div>
  </div>

  <!-- JavaScript -->
  <script>
    // Voice Recording Functionality
    let isRecording = false;
    let mediaRecorder;
    let recordingTimer;
    let startTime;

    const recordBtn = document.getElementById('recordBtn');
    const micIcon = document.getElementById('micIcon');
    const waveform = document.getElementById('waveform');
    const recordingStatus = document.getElementById('recordingStatus');
    const recordingTimerEl = document.getElementById('recordingTimer');

    recordBtn.addEventListener('click', toggleRecording);

    async function toggleRecording() {
      if (!isRecording) {
        startRecording();
      } else {
        stopRecording();
      }
    }

    async function startRecording() {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
        mediaRecorder = new MediaRecorder(stream);

        mediaRecorder.start();
        isRecording = true;

        // Update UI
        recordBtn.classList.remove('bg-red-500', 'hover:bg-red-600');
        recordBtn.classList.add('bg-red-600', 'animate-pulse');
        waveform.classList.remove('hidden');
        recordingStatus.textContent = 'Recording...';
        recordingTimerEl.classList.remove('hidden');

        // Start timer
        startTime = Date.now();
        recordingTimer = setInterval(updateTimer, 100);

      } catch (err) {
        console.error('Error accessing microphone:', err);
        alert('Could not access microphone. Please check permissions.');
      }
    }

    function stopRecording() {
      if (mediaRecorder && isRecording) {
        mediaRecorder.stop();
        isRecording = false;

        // Stop all tracks
        mediaRecorder.stream.getTracks().forEach(track => track.stop());

        // Update UI
        recordBtn.classList.remove('bg-red-600', 'animate-pulse');
        recordBtn.classList.add('bg-red-500', 'hover:bg-red-600');
        waveform.classList.add('hidden');
        recordingStatus.textContent = 'Recording saved';

        // Stop timer
        clearInterval(recordingTimer);

        setTimeout(() => {
          recordingStatus.textContent = 'Click to start recording';
          recordingTimerEl.classList.add('hidden');
        }, 2000);
      }
    }

    function updateTimer() {
      if (isRecording) {
        const elapsed = Date.now() - startTime;
        const minutes = Math.floor(elapsed / 60000);
        const seconds = Math.floor((elapsed % 60000) / 1000);
        recordingTimerEl.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
      }
    }

    // Image Upload Preview
    const imageUpload = document.getElementById('imageUpload');
    const imageThumbnails = document.getElementById('imageThumbnails');
    const imageUploadPrompt = document.getElementById('imageUploadPrompt');
    const addMoreImages = document.getElementById('addMoreImages');
    let uploadedImages = [];

    imageUpload.addEventListener('change', function (e) {
      const newFiles = Array.from(e.target.files);

      // Add new files to existing array
      newFiles.forEach(file => {
        if (file.type.startsWith('image/')) {
          uploadedImages.push(file);
        }
      });

      displayImageThumbnails();
    });

    function displayImageThumbnails() {
      imageThumbnails.innerHTML = '';

      if (uploadedImages.length > 0) {
        // Hide upload prompt and show thumbnails
        imageUploadPrompt.classList.add('hidden');
        imageThumbnails.classList.remove('hidden');
        addMoreImages.classList.remove('hidden');

        uploadedImages.forEach((file, index) => {
          const reader = new FileReader();
          reader.onload = function (e) {
            const thumbnailDiv = document.createElement('div');
            thumbnailDiv.className = 'relative group cursor-pointer';
            thumbnailDiv.innerHTML = `
              <div class="aspect-square bg-slate-100 rounded-lg overflow-hidden border-2 border-slate-200 hover:border-yanmar-red transition-colors shadow-sm">
                <img src="${e.target.result}" alt="Thumbnail ${index + 1}" class="w-full h-full object-cover" />
                <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-all duration-200 flex items-center justify-center">
                  <svg class="w-6 h-6 text-white opacity-0 group-hover:opacity-100 transition-opacity" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                  </svg>
                </div>
                <button class="absolute top-2 right-2 w-6 h-6 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600 flex items-center justify-center shadow-lg" onclick="removeImage(${index})">
                  <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                  </svg>
                </button>
              </div>
            `;

            // Add click event to show in modal
            thumbnailDiv.onclick = function (event) {
              if (event.target.tagName !== 'BUTTON' && !event.target.closest('button')) {
                showImageModal(e.target.result, `Image ${index + 1}`, file.name);
              }
            };

            imageThumbnails.appendChild(thumbnailDiv);
          };
          reader.readAsDataURL(file);
        });
      } else {
        // Show upload prompt and hide thumbnails
        imageUploadPrompt.classList.remove('hidden');
        imageThumbnails.classList.add('hidden');
        addMoreImages.classList.add('hidden');
      }
    }

    // Video Upload Preview
    const videoUpload = document.getElementById('videoUpload');
    const videoThumbnails = document.getElementById('videoThumbnails');
    const videoUploadPrompt = document.getElementById('videoUploadPrompt');
    const addMoreVideos = document.getElementById('addMoreVideos');
    let uploadedVideos = [];

    videoUpload.addEventListener('change', function (e) {
      const newFiles = Array.from(e.target.files);

      // Add new files to existing array
      newFiles.forEach(file => {
        if (file.type.startsWith('video/')) {
          uploadedVideos.push(file);
        }
      });

      displayVideoThumbnails();
    });

    function displayVideoThumbnails() {
      videoThumbnails.innerHTML = '';

      if (uploadedVideos.length > 0) {
        // Hide upload prompt and show thumbnails
        videoUploadPrompt.classList.add('hidden');
        videoThumbnails.classList.remove('hidden');
        addMoreVideos.classList.remove('hidden');

        uploadedVideos.forEach((file, index) => {
          const video = document.createElement('video');
          video.src = URL.createObjectURL(file);
          video.load();

          video.onloadedmetadata = function () {
            // Create thumbnail canvas
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = 200;
            canvas.height = 150;

            video.currentTime = 1; // Seek to 1 second for thumbnail
            video.onseeked = function () {
              ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

              const thumbnailDiv = document.createElement('div');
              thumbnailDiv.className = 'relative group cursor-pointer';
              thumbnailDiv.innerHTML = `
                <div class="relative bg-slate-100 rounded-lg overflow-hidden border-2 border-slate-200 hover:border-yanmar-red transition-colors shadow-sm">
                  <img src="${canvas.toDataURL()}" alt="Video Thumbnail ${index + 1}" class="w-full h-32 sm:h-24 object-cover" />
                  <div class="absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center">
                    <div class="w-12 h-12 sm:w-10 sm:h-10 bg-white bg-opacity-90 rounded-full flex items-center justify-center group-hover:bg-yanmar-red group-hover:text-white transition-colors shadow-lg">
                      <svg class="w-6 h-6 sm:w-5 sm:h-5 ml-0.5" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M8 5v14l11-7z"/>
                      </svg>
                    </div>
                  </div>
                  <div class="absolute bottom-2 left-2 bg-black bg-opacity-75 text-white text-xs px-2 py-1 rounded">
                    ${formatDuration(video.duration)}
                  </div>
                  <button class="absolute top-2 right-2 w-6 h-6 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600 flex items-center justify-center shadow-lg" onclick="removeVideo(${index})">
                    <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                  </button>
                </div>
                <div class="mt-2 text-xs text-slate-500 truncate font-medium">${file.name}</div>
              `;

              // Add click event to show in modal
              thumbnailDiv.onclick = function (event) {
                if (event.target.tagName !== 'BUTTON' && !event.target.closest('button')) {
                  showVideoModal(video.src, file.name);
                }
              };

              videoThumbnails.appendChild(thumbnailDiv);
            };
          };
        });
      } else {
        // Show upload prompt and hide thumbnails
        videoUploadPrompt.classList.remove('hidden');
        videoThumbnails.classList.add('hidden');
        addMoreVideos.classList.add('hidden');
      }
    }

    // Modal Functions
    const modal = document.getElementById('mediaModal');
    const modalContent = document.getElementById('modalContent');
    const closeModal = document.getElementById('closeModal');

    function showImageModal(src, title, filename = '') {
      modalContent.innerHTML = `
        <div class="p-6">
          <div class="flex items-center justify-between mb-4">
            <div>
              <h3 class="text-lg font-semibold text-yanmar-dark">${title}</h3>
              ${filename ? `<p class="text-sm text-slate-500 mt-1">${filename}</p>` : ''}
            </div>
          </div>
          <div class="bg-slate-50 rounded-lg p-4">
            <img src="${src}" alt="${title}" class="w-full max-h-96 object-contain rounded-lg mx-auto" />
          </div>
        </div>
      `;
      modal.classList.remove('hidden');
    }

    function showVideoModal(src, title) {
      modalContent.innerHTML = `
        <div class="p-6">
          <div class="flex items-center justify-between mb-4">
            <div>
              <h3 class="text-lg font-semibold text-yanmar-dark">Video Preview</h3>
              <p class="text-sm text-slate-500 mt-1">${title}</p>
            </div>
          </div>
          <div class="bg-slate-50 rounded-lg p-4">
            <video src="${src}" controls class="w-full max-h-96 rounded-lg mx-auto" preload="metadata">
              Your browser does not support video playback.
            </video>
          </div>
        </div>
      `;
      modal.classList.remove('hidden');
    }

    // Close modal events
    closeModal.onclick = function () {
      modal.classList.add('hidden');
      // Stop any playing videos
      const videos = modalContent.querySelectorAll('video');
      videos.forEach(video => {
        video.pause();
        video.currentTime = 0;
      });
    };

    modal.onclick = function (e) {
      if (e.target === modal) {
        closeModal.onclick();
      }
    };

    // Utility functions
    function formatDuration(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${mins}:${secs.toString().padStart(2, '0')}`;
    }

    function removeImage(index) {
      // Remove from uploaded images array
      uploadedImages.splice(index, 1);

      // Refresh thumbnails display
      displayImageThumbnails();

      // Clear input to allow re-selecting same files
      imageUpload.value = '';
    }

    function removeVideo(index) {
      // Remove from uploaded videos array
      uploadedVideos.splice(index, 1);

      // Refresh thumbnails display
      displayVideoThumbnails();

      // Clear input to allow re-selecting same files
      videoUpload.value = '';
    }

    // Document Upload Preview
    const documentUpload = document.getElementById('documentUpload');
    const documentThumbnails = document.getElementById('documentThumbnails');
    const documentUploadPrompt = document.getElementById('documentUploadPrompt');
    const addMoreDocuments = document.getElementById('addMoreDocuments');
    let uploadedDocuments = [];

    documentUpload.addEventListener('change', function (e) {
      const newFiles = Array.from(e.target.files);

      // Add new files to existing array
      newFiles.forEach(file => {
        uploadedDocuments.push(file);
      });

      displayDocumentThumbnails();
    });

    function displayDocumentThumbnails() {
      documentThumbnails.innerHTML = '';

      if (uploadedDocuments.length > 0) {
        // Hide upload prompt and show thumbnails
        documentUploadPrompt.classList.add('hidden');
        documentThumbnails.classList.remove('hidden');
        addMoreDocuments.classList.remove('hidden');

        uploadedDocuments.forEach((file, index) => {
          const fileIcon = getFileIcon(file.name);
          const fileSize = formatFileSize(file.size);

          const documentDiv = document.createElement('div');
          documentDiv.className = 'flex items-center p-3 bg-white border border-slate-200 rounded-lg hover:border-yanmar-red transition-colors group';
          documentDiv.innerHTML = `
            <div class="flex-shrink-0 mr-3">
              ${fileIcon}
            </div>
            <div class="flex-1 min-w-0">
              <div class="text-sm font-medium text-yanmar-dark truncate">${file.name}</div>
              <div class="text-xs text-slate-500">${fileSize}</div>
            </div>
            <button class="flex-shrink-0 w-6 h-6 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600 flex items-center justify-center ml-2" onclick="removeDocument(${index})">
              <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>
          `;

          // Add click event for file preview (if applicable)
          documentDiv.onclick = function (event) {
            if (event.target.tagName !== 'BUTTON' && !event.target.closest('button')) {
              // For now, just show file info
              showDocumentModal(file);
            }
          };

          documentThumbnails.appendChild(documentDiv);
        });
      } else {
        // Show upload prompt and hide thumbnails
        documentUploadPrompt.classList.remove('hidden');
        documentThumbnails.classList.add('hidden');
        addMoreDocuments.classList.add('hidden');
      }
    }

    function removeDocument(index) {
      // Remove from uploaded documents array
      uploadedDocuments.splice(index, 1);

      // Refresh thumbnails display
      displayDocumentThumbnails();

      // Clear input to allow re-selecting same files
      documentUpload.value = '';
    }

    function getFileIcon(filename) {
      const extension = filename.split('.').pop().toLowerCase();
      const iconClass = 'w-8 h-8 text-yanmar-red';

      switch (extension) {
        case 'pdf':
          return `<svg class="${iconClass}" fill="currentColor" viewBox="0 0 24 24"><path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/></svg>`;
        case 'doc':
        case 'docx':
          return `<svg class="${iconClass}" fill="currentColor" viewBox="0 0 24 24"><path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/></svg>`;
        case 'xls':
        case 'xlsx':
          return `<svg class="${iconClass}" fill="currentColor" viewBox="0 0 24 24"><path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/></svg>`;
        case 'ppt':
        case 'pptx':
          return `<svg class="${iconClass}" fill="currentColor" viewBox="0 0 24 24"><path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/></svg>`;
        case 'txt':
          return `<svg class="${iconClass}" fill="currentColor" viewBox="0 0 24 24"><path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/></svg>`;
        default:
          return `<svg class="${iconClass}" fill="currentColor" viewBox="0 0 24 24"><path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/></svg>`;
      }
    }

    function formatFileSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    function showDocumentModal(file) {
      const fileIcon = getFileIcon(file.name);
      const fileSize = formatFileSize(file.size);

      modalContent.innerHTML = `
        <div class="p-6">
          <div class="flex items-center mb-4">
            <div class="mr-4">
              ${fileIcon}
            </div>
            <div>
              <h3 class="text-lg font-semibold text-yanmar-dark">${file.name}</h3>
              <p class="text-sm text-slate-500 mt-1">Size: ${fileSize}</p>
            </div>
          </div>
          <div class="bg-slate-50 rounded-lg p-4 text-center">
            <p class="text-slate-600 mb-4">Document preview not available</p>
            <p class="text-xs text-slate-400">File will be included when form is submitted</p>
          </div>
        </div>
      `;
      modal.classList.remove('hidden');
    }

    // Form Validation
    const form = document.querySelector('form');
    form.addEventListener('submit', function (e) {
      e.preventDefault();

      // Simple validation check
      const requiredFields = form.querySelectorAll('[required]');
      let isValid = true;

      requiredFields.forEach(field => {
        if (!field.value.trim()) {
          field.classList.add('border-red-500');
          isValid = false;
        } else {
          field.classList.remove('border-red-500');
        }
      });

      if (isValid) {
        // Show success message
        const successMsg = document.createElement('div');
        successMsg.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
        successMsg.textContent = 'QC Report submitted successfully!';
        document.body.appendChild(successMsg);

        setTimeout(() => {
          successMsg.remove();
        }, 3000);

        // Reset form
        form.reset();
      } else {
        // Show error message
        const errorMsg = document.createElement('div');
        errorMsg.className = 'fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
        errorMsg.textContent = 'Please fill in all required fields.';
        document.body.appendChild(errorMsg);

        setTimeout(() => {
          errorMsg.remove();
        }, 3000);
      }
    });

    // Auto-save draft functionality
    let autoSaveTimer;
    const formInputs = form.querySelectorAll('input, select, textarea');

    formInputs.forEach(input => {
      input.addEventListener('input', function () {
        clearTimeout(autoSaveTimer);
        autoSaveTimer = setTimeout(saveDraft, 30000); // Auto-save every 30 seconds
      });
    });

    function saveDraft() {
      // Simulate saving draft
      const draftMsg = document.createElement('div');
      draftMsg.className = 'fixed bottom-4 right-4 bg-yanmar-red text-white px-4 py-2 rounded shadow-lg z-50';
      draftMsg.textContent = 'Draft saved';
      document.body.appendChild(draftMsg);

      setTimeout(() => {
        draftMsg.remove();
      }, 2000);
    }
  </script>

  <!-- Custom Styles -->
  <style>
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-fadeInUp {
      animation: fadeInUp 0.6s ease-out;
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-track {
      background: #f1f5f9;
    }

    ::-webkit-scrollbar-thumb {
      background: #cbd5e1;
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #94a3b8;
    }

    /* File upload hover effects */
    input[type="file"]+label:hover {
      background-color: #f8fafc;
    }

    /* Smooth transitions */
    * {
      transition: all 0.2s ease;
    }
  </style>
</body>

</html>